# Use Ubuntu as base
FROM ubuntu:latest

# Enable 32-bit architecture for Wine
RUN dpkg --add-architecture i386 && apt update

# Install dependencies including wine32
RUN apt install -y wine wget unzip wine32:i386 xvfb

# Set up working directory
WORKDIR /pestudio

# Copy required files
COPY pestudio /pestudio
COPY malware_analysis.py /app/malware_analysis.py
COPY scan_file.sh /app/scan_file.sh

# Make the scan script executable
RUN chmod +x /app/scan_file.sh

# Use a virtual X display to run Wine in headless mode
CMD Xvfb :0 -screen 0 1024x768x16 & DISPLAY=:0 wine /pestudio/pestudio.exe
